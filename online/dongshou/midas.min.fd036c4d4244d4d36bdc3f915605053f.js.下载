function setMidas(){var f,n=50,o=50,j=!0,k=!0,r=!0,p=function(){return document.querySelectorAll("[data-midas]")},q=function(a,d){var b="";a&&(-1<a.indexOf("?")?b=a:(b=window.location.host,b=-1<b.indexOf("dianping.com")&&!/^ppe/.test(b)?location.protocol+"//mlog.dianping.com/log?":-1<b.indexOf("meituan.com")&&!/test/.test(b)?location.protocol+"//mlog.dianping.com/log?":location.protocol+"//mlog.51ping.com/log?",b+=decodeURIComponent(a)),b=b+"&act="+d+"&referer="+encodeURIComponent(document.referrer)+
"&t="+(new Date).getTime(),l(b))},l=function(a){var d=new Image(1,1);d.onload=d.onerror=function(){d=null};d.src=a},v=function(a){var d=this.getAttribute("data-midas"),b=this.getAttribute("data-clickurl");k&&(a&&a.stopPropagation?a.stopPropagation():window.event.cancelBubble=!0);if(this.getAttribute("data-inner-jump"))d=d+"&referer="+encodeURIComponent(document.referrer)+"|"+(b?b:""),a="",a=-1!==location.host.indexOf("dianping")?"dianping.com":"51ping.com",document.cookie="midasclick="+encodeURIComponent(d)+
"; path=/; domain="+a,window.location.href=this.getAttribute("data-linkurl");else{var c=a.target,h=c.getAttribute("data-midas-extends"),a=this.getAttribute("data-clickurl"),b=d;if(h)b=d+"&"+h;else{for(c=c.parentNode;"BODY"==c.nodeName&&!c.getAttribute("data-midas-extends");)c=c.parentNode;(c=c.getAttribute("data-midas-extends"))&&(b=d+"&"+c)}q(b,2);a&&l(a)}},t=function(){for(var a=p(),d=0,b=a.length;d<b;d++){var c=a[d],h=c.getAttribute("data-midas"),s=c.getAttribute("data-impressionurl"),e;var g=
c;e=g.getBoundingClientRect();if(0===e.width||0===e.height||"0"===g.style.opacity)e=!1;else{var m=g.offsetHeight,i=g.offsetWidth,g=n>m?m:n,f=o>i?i:o,j=(window.innerHeight||document.documentElement.clientHeight)-(e.bottom-m)>=g,k=e.left+i>=f,i=(window.innerWidth||document.documentElement.clientWidth)-(e.right-i)>=f;e=e.top+m>=g&&j&&k&&i}e&&!c.getAttribute("data-midas-impressed")&&(q(h,3),s&&l(s),c.setAttribute("data-midas-impressed","true"))}},u=function(a){r&&(a&&a.stopPropagation?a.stopPropagation():
window.event.cancelBubble=!0);clearTimeout(f);f=setTimeout(function(){t()},200)};document.midas={init:function(a){a&&this.config(a);j&&this.view();this.initClick();this.initImpression();a=new Event("scroll");window.dispatchEvent(a);this.reach()},config:function(a){void 0!==a.inScreenHeight&&("number"===typeof a.inScreenHeight&&0<=a.inScreenHeight)&&(n=a.inScreenHeight);void 0!==a.inScreenWidth&&("number"===typeof a.inScreenWidth&&0<=a.inScreenWidth)&&(o=a.inScreenWidth);void 0!==a.sendView&&"boolean"===
typeof a.sendView&&(j=a.sendView);void 0!==a.stopClickPropagation&&"boolean"===typeof a.stopClickPropagation&&(k=a.stopClickPropagation);void 0!==a.stopScrollPropagation&&"boolean"===typeof a.stopScrollPropagation&&(r=a.stopScrollPropagation)},view:function(){for(var a=p(),d=0,b=a.length;d<b;d++){var c=a[d],h=c.getAttribute("data-midas"),f=c.getAttribute("data-pvurl");c.getAttribute("data-viewed")||(q(h,1),f&&l(f),c.setAttribute("data-viewed","true"))}},initImpression:function(){window.attachEvent?
window.attachEvent("onscroll",u):window.addEventListener("scroll",u,!1)},impression:function(){t()},initClick:function(){for(var a=p(),d=0,b=a.length;d<b;d++){var c=a[d];c.getAttribute("data-midas");c.getAttribute("data-click-inited")||(c.addEventListener("click",v),c.setAttribute("data-click-inited","true"))}},reach:function(){var a=location.search.slice(1),d={},b,c=0;if(-1<a.indexOf("feedback")||-1<a.indexOf("_fb_")){-1<a.indexOf("feedback")&&(b=a.split("feedback="));-1<a.indexOf("_fb_")&&(b=a.split("_fb_="));
a=b[b.length-1];a=-1<a.indexOf("&")?decodeURIComponent(a.split("&")[0]):decodeURIComponent(a);a=a.split("&");for(c;c<a.length;c+=1)b=a[c].split("="),2==b.length&&(d[b[0]]=b[1]);_hip&&_hip.push&&_hip.push(["mv",d])}}};document.midas.rich=document.midas.reach}setMidas();window.DP&&window.DP.define&&window.DP.define([],function(){});
